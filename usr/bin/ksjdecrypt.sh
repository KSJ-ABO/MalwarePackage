#!/bin/bash

ENCRYPTED_FILE="./test-encrypted.aes"
DECRYPTED_FILE="./test-decrypted.tar.gz"
PASSWORD="YOUAREHERO"

# Check if OpenSSL is installed
if ! command -v openssl &> /dev/null; then
    echo "Error: OpenSSL is not installed. Installing it now..."
    apt-get update
    apt-get install -y openssl
fi

if [ -f "$ENCRYPTED_FILE" ]; then
    read -sp "[*] Enter the password for decryption: " input_password
    echo

    if [ "$input_password" == "$PASSWORD" ]; then
        echo "[*] Starting decryption..."
        openssl enc -aes-256-cbc -salt -pbkdf2 -d -pass pass:"$PASSWORD" -in "$ENCRYPTED_FILE" -out "$DECRYPTED_FILE"
        
        if [ $? -eq 0 ]; then
            echo "[*] Decryption completed. Check $DECRYPTED_FILE."
            echo "[*] You can extract the contents with: tar -xzf $DECRYPTED_FILE -C /desired/output/directory"
        else
            echo "[*] Error: Decryption failed."
        fi
    else
        echo "[*] Error: Incorrect password."
    fi
else
    echo "[*] Error: Encrypted file $ENCRYPTED_FILE does not exist."
fi
